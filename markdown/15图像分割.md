# 人工智能

## 图像分割

### 什么是图像分割？

- 图像分割就是把图像分成若干个特定的、具有独特性质的区域并提出感兴趣目标的技术。图像分割不仅要正确地找到图像中的对象，还要对其精确的分割，图像分割可以看做是目标检测和语义分割的结合。分割是像素级别的，需要非常的精确。
- 应用

	- 1.医疗分割(CT/MR)
	- 2.自动驾驶
	- 3.卫星定位物体

- 发展：分类——分类加追踪——多分类加追踪——分割
- 分类

	- 普通分割：将归属不同物体的像素区域分开。
	- 语义分割：在普通分割基础上，分类出每一块区域的语义(这块区域属于哪一类)。
	- 实例分割：在语义分割基础上，分类出该区域属于哪一类中的哪一种。

- 结构

	- 一种哑铃结构，前半段是编码结构，后半段是解码结构。
	- 下采样方法：

		- 1.大步长的卷积
		- 2.池化(最大、平均、自适应)
		- 最大池化：提取轮廓，一般用在提取重要信息。
		- 平均池化：提取背景，一般在网络最后进行输出时使用。

	- 上采样方法：

		- 1.转置卷积：还原一个完全相同的形状，但是不能完全还原原图。需要学习，参数较大。
		- 2.像素插值：邻近、双线性、线性插值法。
		- 3.像素融合：通道信息平铺。

### 图像分割的模型

- Mask R-CNN

	- 资料

		- 论文

			- https://arxiv.org/pdf/1703.06870.pdf

		- 项目地址

			- https://github.com/facebookresearch/Detectron

			- https://github.com/matterport/Mask_RCNN

	- 简介

		- 基于Faster R-CNN(用于目标检测)，添加一个掩码分支(作用于每个RoI的小FCN，以像素到像素的方式预测分割掩码，用于语义分割)。
		- 框架

		- 关键特点

			- 1）Mask R-CNN为每个RoI输出二进制掩码。

				- Faster R-CNN的两个阶段：

					- 第一阶段，RPN提取候选目标边界框。
					- 第二阶段，使用RoIPool从每个候选框中提取特征，并进行分类和边界回归。

				- Mask R-CNN在第二阶段还为每个RoI输出二进制掩码。

			- 2）使用Sigmoid+二分类损失替换Softmax+多分类损失。

				- 若有K个类别，则mask分割分支的输出维度就是K*m*m。每个类别使用Sigmoid输出并计算二值损失，可以避免类间竞争，较好地提升性能。

			- 3）引入RoI Align代替RoI Pooling。

				- RoI Pooling：为了将大小不同的RoI统一成相同尺寸。但是其不是按照像素对齐的，这对分类没什么影响，但是对分割却影响很大。

					- 局限性分析

						- 1）将候选框边界(模型得到的一般是浮点数)量化为整数点坐标值。
						- 2）将量化后的边界区域平均分割成k*k个单元，对每个单元的边界进行量化。
						- 经过两次量化，候选框已经和最开始回归出来的位置有一定的偏差。

				- RoI Align：

					- 1）遍历每个候选区域，保持浮点数边界不做量化。
					- 2）将候选区域分割成k*k个单元，每个单元的边界也不做量化。
					- 3）在每个单元中(用双线性内插的方法)计算固定四个坐标位置，然后对每个单元格的4个采样点进行最大池化操作。

						- 什么是双线性插值？

							- 即在两个方向分别进行一次线性插值。
							- 第一步：X方向的线性插值，在Q12,Q22中插入蓝色点R2，Q11，Q21中插入蓝色点R1；
							- 第二步 ：Y方向的线性插值 ,通过第一步计算出的R1与R2在y方向上插值计算出P点。
							- 注意：双线性插值的结果与插值的顺序无关。先进行y方向插值，再进行x方向插值的结果是一样的。

- FCN(全卷积模型)

	- 问题：1）有池化，会丢掉一些信息。2）跳跃连接的concat数量不足。

- UNet系列

	- UNet

		- 先编码(下采样)再解码(上采样)的U形结构，保持输入和输出大小一样。
		- 在FCN中，Skip connection的联合是通过对应像素的求和，而U-Net是对其channel的concat过程。
		- 下采样用的是卷积。
		- 上采样用的是临近插值。
		- UNet在医学中的应用：医学图片比较大，一般采用分块裁剪下来进行分割，然后再拼接起来。

	- UNet++

		- 借鉴了DenseNet的密集连接，改进Skip connection。
		- 每一层都有一个loss的输出，4个损失相互促进。

	- U²-NET

		- 嵌套U结构；设计了一种新的ReSidual U-blocks (RSU)，能在不降低特征图分辨率的情况下提取多尺度特征。

