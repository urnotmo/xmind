# 图像增强

## 图像增强

### 简介

- 1.什么是图像增强及其如何改善深度神经网络的性能？

	- 深度网络需要大量的训练数据才能获得良好的结果并防止过拟合。但是，通常很难获得足够的训练样本。多种原因可能会使收集足够的数据变得非常困难，甚至不可能：

		- 1）要制作训练数据集，您需要获取图像，然后对其进行标记。

			- 例如，如果您有图像分类任务，则需要分配正确的类别标签。对于对象检测任务，您需要在对象周围绘制边界框。对于语义分割任务，您需要为每个输入图像像素分配一个正确的类。该过程需要体力劳动，有时标记训练数据可能非常昂贵。例如，要正确标记医学图像，您需要昂贵的领域专家。

		- 2）有时甚至收集训练图像也可能很困难。

			- 处理医疗保健数据有许多法律限制，要获取它需要付出很多努力。有时获取训练图像更可行，但这会花费很多钱。例如，要获取卫星图像，您需要向卫星运营商付款以拍摄这些照片。为了获得用于道路场景识别的图像，您需要操作员来驾驶汽车并收集所需的数据。

	- 图像增强技术：

		- 图像增强是从现有示例中创建新训练示例的过程。

			- 示例

				- 通过将这些转换应用于原始训练数据集，您可以创建几乎无限数量的新训练样本。

		- 两种类型

			- 像素级：改变原始图像的像素值，但不会改变输出mask。如：改变亮度、色度、对比度。
			- 空间级：同时改变图像和mask。但对图像使用镜像、旋转、裁剪等空间级增强变换时，还需要将相同的变换应用于输出标签以保证其正确性。

	- 图像增强在多大程度上改善了深度神经网络的质量和性能：

		- 一个模型在ImageNet验证集上的Top-1 accuracy (%)：

		- 多样化的图像增强可以提高神经网络的性能，并有助于防止过拟合。

- 2.为什么需要专用的图像增强库？

	- 有很多库可以进行此类图像转换，以Pillow进行简单的扩充为例：

		- 这种方法有很多局限性，并且不能通过图像增强来处理所有情况。

	- 对目标检测、图像分割和关键点检测等任务，需要对图像和标签使用相同的转换。

		- 图像分类(标签不用变换)

			- 只需修改输入图像并保持输出标签完成即可，输出标签对于图像修改是不变的。
			- 对于不同的任务，并不是所有的增强方式都适用。例如分类任务，如果使用"裁剪"的方式，可能到时输出标签错误(如右图)。通过对数据集分析应用哪些扩充方式来应对这种情况。

		- 图像分割

			- 像素级增强，mask不变：

			- 空间级增强，mask做相同变换：

		- 目标检测

			- 同样的，对于像素级增强，只需要更改输入图像即可。使用空间级增强，不仅需要对图像应用相同变换，还需要对边界框坐标应用相同的变换。应用空间级别的增强后，您需要更新边界框的坐标以表示增强图像上对象的正确位置。

	- 不同的数据集，增强百分比不同。

		- 1）如果原始数据集很大，则只能应用基本增强，其概率约为10-30％，并且变化幅度很小。
		- 2）如果数据集很小，则需要对增强进行更积极的操作，以防止神经网络过度拟合，因此通常需要将应用每种增强的可能性提高到40-50％，并增加增强对图像的更改幅度。

	- albumentations允许设置每个转换的概率和值的大小。

- 3.albumentations的优点

	- 1）高性能：基于numpy、OpenCV，在大多数转换中，这个库比其他库更快。
	- 2）多样性：支持60多种不同方式的图像增强。
	- 3）可扩展性：简单、灵活的API，允许库在任何计算机视觉管道中使用。
	- 4）应用广泛：广泛应用于工业、深度学习研究、机器学习竞赛、开源项目等。
	- 5）严格的测试：增强操作中的bug会使数据不准确，降低模型性能。Albumentations有一个广泛的测试套件，可以帮助在开发期间发现bug。

### albumentations

- 学习资料

	- 官网

		- https://albumentations.readthedocs.io/en/latest/

	- github

		- https://github.com/albumentations-team/albumentations

		- https://github.com/albumentations-team/albumentations_examples

	- 文档

		- https://albumentations.ai/docs/

- 简介

	- Albumentations是一个快速而灵活的图像增强库，广泛应用于工业、深度学习研究、机器学习竞赛、开源项目等。Albumentations是用Python实现的，并已获得MIT许可。

- 入门

	- 安装

		- 1）从PyPI安装最新的稳定版本：

			- pip install -U albumentations

		- 2）从GitHub的master分支安装最新版本：

			- pip install -U git+https://github.com/albumentations-team/albumentations

		- 3）从conda-forge安装最新的稳定版本：

			- 如果您正在使用Anaconda或Miniconda，则可以从conda-forge安装Albumentations：
			- conda install -c conda-forge imgaug
conda install -c conda-forge albumentations

### imgaug

- 学习资料

	- 官网

		- https://imgaug.readthedocs.io/en/latest/

